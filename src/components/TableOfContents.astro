---
interface Heading {
  depth: number;
  slug: string;
  text: string;
}

interface Props {
  headings: Heading[];
}

const { headings = [] } = Astro.props;
const visible = headings.filter((heading) => heading.depth >= 2 && heading.depth <= 3);
---

{visible.length > 0 && (
  <aside class="hidden xl:block w-64 sticky top-[90px] self-start bg-secondary/85 border border-slate-900/10 rounded-xl p-4 lg:p-5 backdrop-blur-sm max-h-[calc(100vh-108px)] overflow-y-auto overscroll-contain sidebar-scroll">
    <p class="text-xs tracking-widest text-slate-500 mb-4 font-mono">ON THIS PAGE</p>
    <ul class="space-y-2">
      {visible.map((heading) => (
        <li>
          <a
            href={`#${heading.slug}`}
            class:list={[
              'block text-sm text-slate-500 hover:text-slate-900 transition-colors leading-relaxed',
              heading.depth === 3 ? 'pl-3' : 'pl-0',
            ]}
          >
            {heading.text}
          </a>
        </li>
      ))}
    </ul>
  </aside>
)}
