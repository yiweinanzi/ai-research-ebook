---
import Layout from '../layouts/Layout.astro';
import Terminal from '../components/Terminal.astro';
import DocCard from '../components/DocCard.astro';
import { getCollection } from 'astro:content';

const docs = await getCollection('docs');

const categoryMeta = [
  { key: 'idea', title: 'Idea ç”Ÿæˆ', icon: 'ğŸ’¡', desc: 'ä»æ–‡çŒ®è°ƒç ”åˆ°å¯éªŒè¯ claimã€‚' },
  { key: 'code', title: 'ä»£ç å®ç°', icon: 'âš™ï¸', desc: 'ç”¨ Claude / GPT / Agent æ¡†æ¶è½åœ°å®éªŒã€‚' },
  { key: 'figures', title: 'è®ºæ–‡å›¾è¡¨', icon: 'ğŸ“Š', desc: 'æŠŠå®éªŒç»“æœè½¬æˆå¯æŠ•ç¨¿çš„è§†è§‰è¡¨è¾¾ã€‚' },
  { key: 'writing', title: 'è®ºæ–‡å†™ä½œ', icon: 'âœï¸', desc: 'æ„å»ºè®ºè¯é“¾å¹¶å®Œæˆå®Œæ•´è®ºæ–‡åˆç¨¿ã€‚' },
  { key: 'review', title: 'å®¡ç¨¿ä¸ Rebuttal', icon: 'ğŸ§ª', desc: 'ç»“æ„åŒ–æŒ‘åˆºä¸å›åº”ç­–ç•¥é—­ç¯ã€‚' },
  { key: 'tools', title: 'å·¥å…·ç”Ÿæ€', icon: 'ğŸ› ï¸', desc: 'ç§‘ç ”å…¨æµç¨‹å·¥å…·çŸ©é˜µä¸ç»„åˆç­–ç•¥ã€‚' },
  { key: 'library', title: 'èµ„æ–™åº“', icon: 'ğŸ“š', desc: 'æŠ•ç¨¿ä¸ç§‘ç ”å®æˆ˜é•¿æœŸå‚è€ƒæ‰‹å†Œã€‚' },
] as const;

const chapterCards = categoryMeta.map((meta) => {
  const items = docs
    .filter((doc) => doc.data.category === meta.key)
    .sort((a, b) => a.data.order - b.data.order);

  return {
    ...meta,
    count: items.length,
    first: items[0],
  };
});

const timeline = [
  { step: '01', title: 'Idea', tool: 'Research + Analysis', desc: 'è°ƒç ”æ–‡çŒ®å¹¶æ‰¾å‡ºå¯å†™çš„ç ”ç©¶ç©ºç™½', icon: 'ğŸ’¡' },
  { step: '02', title: 'Code', tool: 'Claude Code / GPT', desc: 'æ­å»ºå®éªŒç®¡çº¿å¹¶å®ç°æ ¸å¿ƒæ¨¡å—', icon: 'âš¡' },
  { step: '03', title: 'Figures', tool: 'Mermaid / Figma', desc: 'æ²‰æ·€æ¶æ„å›¾ã€æµç¨‹å›¾å’Œæ ¸å¿ƒç»“æœå›¾', icon: 'ğŸ“ˆ' },
  { step: '04', title: 'Writing', tool: 'Prism / å¤šæ¨¡å‹åä½œ', desc: 'å®Œæˆè®ºè¯é“¾ä¸ç« èŠ‚å†™ä½œ', icon: 'ğŸ“' },
  { step: '05', title: 'Review', tool: 'Structured Review', desc: 'å¤šè½®å®¡ç¨¿æ¨¡æ‹Ÿå’Œ rebuttal è¿­ä»£', icon: 'ğŸš€' },
];

const quickPaths = [
  {
    title: 'æ–°æ‰‹è·¯å¾„',
    desc: 'å…ˆå»ºç«‹è°ƒç ”æ–¹æ³•ï¼Œå†è¿›å…¥é¡¹ç›®çº§è°ƒç ”ä¸å®éªŒè®¾è®¡ã€‚',
    docs: ['/docs/idea/01-research', '/docs/idea/02-projects', '/docs/code/01-claude'],
  },
  {
    title: 'å¿«é€Ÿè½åœ°è·¯å¾„',
    desc: 'ç›´æ¥çœ‹å®Œæ•´å·¥ä½œæµï¼Œå†é…å®¡ç¨¿æ¨¡æ¿åšé—­ç¯ã€‚',
    docs: ['/docs/tools/02-workflow', '/docs/review/01-structured', '/docs/review/02-templates'],
  },
  {
    title: 'å·¥ç¨‹æ•ˆç‡è·¯å¾„',
    desc: 'å…ˆæŒæ¡å¤š Agentï¼Œå†è¡¥å·¥å…·æ ˆå’Œå†™ä½œåä½œã€‚',
    docs: ['/docs/code/03-agents', '/docs/tools/01-overview', '/docs/writing/03-collaboration'],
  },
];

const cooperationCards = [
  {
    icon: 'ğŸ§­',
    title: 'ç« èŠ‚å¯¼èˆªå¯¼å­¦',
    desc: 'æŒ‰â€œè°ƒç ”-å®ç°-å†™ä½œ-å®¡ç¨¿â€èŠ‚å¥å¿«é€Ÿä¸²èµ·å…¨ä¹¦ï¼Œé€‚åˆç¬¬ä¸€æ¬¡å®Œæ•´é˜…è¯»ã€‚',
    cta: 'è¿›å…¥å¯¼è¯»',
    href: '/docs/intro/01-overview',
    style: 'bg-gradient-to-br from-secondary to-tertiary',
  },
  {
    icon: 'ğŸ§ª',
    title: 'å®éªŒè®¾è®¡é€ŸæŸ¥',
    desc: 'ä¼˜å…ˆæŸ¥çœ‹å·¥å…·ã€ä»£ç ä¸å®¡ç¨¿ç« èŠ‚ï¼Œé€‚åˆéœ€è¦å¿«é€Ÿè½åœ°å®éªŒé—­ç¯çš„åœºæ™¯ã€‚',
    cta: 'æŸ¥çœ‹å·¥å…·ç« èŠ‚',
    href: '/docs/tools/01-overview',
    style: 'bg-secondary',
  },
  {
    icon: 'ğŸ›¡ï¸',
    title: 'Rebuttal é¢„æ¼”',
    desc: 'ç”¨ç»“æ„åŒ–æ¨¡æ¿æå‰æš´éœ²è–„å¼±è¯æ®é“¾ï¼Œç¼©çŸ­çœŸæ­£æŠ•ç¨¿å‰çš„è¿­ä»£å‘¨æœŸã€‚',
    cta: 'è¿›å…¥å®¡ç¨¿ç« èŠ‚',
    href: '/docs/review/01-structured',
    style: 'bg-secondary',
  },
];

const getPath = (path: string) => {
  const base = import.meta.env.BASE_URL;
  return base === '/' ? path : `${base.replace(/\/$/, '')}${path}`;
};
---

<Layout title="Vibe Research - AI ç§‘ç ”æŒ‡å—">
  <section class="relative pt-48 pb-32 overflow-hidden">
    <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-900/20 via-transparent to-transparent pointer-events-none"></div>

    <div class="max-w-7xl mx-auto px-6 relative z-10">
      <div class="max-w-4xl mx-auto text-center">
        <div class="inline-flex items-center gap-2 px-3 py-1 bg-slate-900/5 border border-slate-900/10 rounded-full text-sm text-slate-500 mb-8 animate-fade-in-up">
          <span class="flex h-2 w-2 relative">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
          </span>
          <span>Research Flow State: On</span>
        </div>

        <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold tracking-tight mb-8 leading-tight flex flex-col items-center">
          <div class="relative w-max max-w-full">
            <span class="block overflow-hidden border-r-4 border-blue-500 whitespace-nowrap animate-typing animate-blink bg-gradient-to-r from-blue-400 via-blue-500 to-violet-500 bg-clip-text text-transparent pb-2 font-mono">
              Output is the Only Metric
            </span>
          </div>
        </h1>

        <p class="text-lg text-slate-600 text-center mb-8 max-w-3xl mx-auto">
          é¢å‘ AI ç§‘ç ”åœºæ™¯çš„å®Œæ•´æ‰§è¡Œæ‰‹å†Œï¼šä» Ideaã€å®ç°ã€å›¾è¡¨ã€å†™ä½œåˆ°å®¡ç¨¿é—­ç¯ã€‚<br />
          <span class="text-base opacity-70 block mt-2">From ideation to submission, every step is measurable and executable.</span>
          <span class="text-xs text-slate-500 mt-3 block font-mono">18 Chapters Â· 7 Modules Â· Continuous Updates</span>
        </p>

        <div class="text-2xl md:text-3xl text-slate-800 font-bold mb-12 space-y-4">
          <p>Just Build. Then Verify.</p>
          <p class="text-slate-500 text-lg font-normal max-w-2xl mx-auto leading-relaxed">
            AI è´Ÿè´£åŠ é€Ÿå®ç°ï¼Œäººè´Ÿè´£ç ”ç©¶åˆ¤æ–­ã€‚<br />
            æŠŠç§‘ç ”ä»»åŠ¡æ‹†æˆå¯æ‰§è¡Œå•å…ƒï¼ŒæŒç»­éªŒè¯ï¼ŒæŒç»­è¿­ä»£ã€‚
          </p>
        </div>

        <div class="flex flex-col sm:flex-row gap-6 justify-center">
          <a href={getPath('/docs/intro/01-overview')} class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-white text-black rounded-lg font-semibold hover:bg-gray-200 transition-colors text-lg">
            å¼€å§‹é˜…è¯»
          </a>
          <a href="#chapters" class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-slate-900/5 border border-slate-900/15 rounded-lg font-semibold hover:bg-slate-900/10 transition-colors text-lg">
            æŸ¥çœ‹ç« èŠ‚
          </a>
        </div>

        <div class="mt-12 pt-8 border-t border-slate-900/10">
          <p class="text-sm text-slate-500 mb-6 font-mono">MODULES</p>
          <div class="flex flex-wrap gap-4 justify-center">
            {chapterCards.map((chapter) => (
              <a href={chapter.first ? getPath(`/docs/${chapter.first.slug}`) : '#'} class="flex items-center gap-3 px-4 py-2 bg-slate-900/5 border border-slate-900/10 rounded-lg hover:border-blue-500/30 hover:bg-blue-500/5 transition-all duration-300 group min-w-[170px]">
                <span class="text-xl group-hover:scale-110 transition-transform">{chapter.icon}</span>
                <div class="text-left">
                  <div class="text-xs font-bold text-slate-700 group-hover:text-blue-400">{chapter.title}</div>
                  <div class="text-[10px] text-slate-500 font-mono">{chapter.count} chapters</div>
                </div>
              </a>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="workflow" class="py-24 bg-slate-900/5 relative overflow-hidden">
    <div class="max-w-7xl mx-auto px-6 relative z-10">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">ç§‘ç ”æ‰§è¡Œå·¥ä½œæµ</h2>
        <p class="text-slate-600">ç« èŠ‚å‘½åå¯¹é½ä½ çš„ä½“ç³»ï¼Œç»“æ„ä¸äº¤äº’é£æ ¼é é½ adongwanai ç«™ç‚¹</p>
      </div>

      <div class="flex flex-col md:flex-row justify-between items-stretch gap-4 relative">
        <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-blue-500/20 to-transparent -translate-y-1/2 z-0"></div>

        {timeline.map((item) => (
          <div class="relative z-10 bg-secondary border border-slate-900/10 p-6 rounded-xl w-full md:flex-1 hover:-translate-y-2 transition-transform duration-300 min-w-0">
            <div class="text-4xl mb-4">{item.icon}</div>
            <div class="text-xs font-mono text-accent mb-2">STEP {item.step}</div>
            <h3 class="text-lg font-bold mb-1">{item.title}</h3>
            <div class="text-xs text-blue-400 mb-3 font-mono">{item.tool}</div>
            <p class="text-sm text-slate-500 line-clamp-2">{item.desc}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section id="chapters" class="py-24 relative">
    <div class="max-w-7xl mx-auto px-6">
      <div class="mb-16 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">ç« èŠ‚æ¨¡å—</h2>
        <p class="text-slate-600">æŒ‰ä½ çš„ 7 å¤§ç« èŠ‚ä½“ç³»ç»„ç»‡ï¼Œå¡ç‰‡å¯†åº¦ä¸å‚è€ƒç«™çš„é¡¹ç›®åŒºå—é é½</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto">
        {chapterCards.map((chapter) => chapter.first && (
          <DocCard
            title={chapter.title}
            description={chapter.desc}
            href={`/docs/${chapter.first.slug}`}
            icon={chapter.icon}
            stat={`${chapter.count} ç¯‡`}
          />
        ))}
      </div>
    </div>
  </section>

  <section class="py-24">
    <div class="max-w-7xl mx-auto px-6">
      <div class="mb-16 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">å­¦ä¹ è·¯å¾„</h2>
        <p class="text-slate-600">æŒ‰ä¸åŒç›®æ ‡å¿«é€Ÿè¿›å…¥ä½ çš„ç« èŠ‚ä½“ç³»</p>
      </div>

      <div class="grid md:grid-cols-3 gap-6">
        {quickPaths.map((path) => (
          <div class="bg-secondary border border-slate-900/10 rounded-xl p-7 hover:border-accent/50 hover:-translate-y-1 transition-all duration-300">
            <h3 class="text-xl font-bold mb-3">{path.title}</h3>
            <p class="text-sm text-slate-600 mb-6 leading-relaxed">{path.desc}</p>
            <div class="space-y-2">
              {path.docs.map((doc) => (
                <a href={getPath(doc)} class="block text-sm bg-slate-900/5 border border-slate-900/10 rounded-lg px-3 py-2 text-slate-700 hover:text-slate-900 hover:border-accent/40 transition-colors">
                  {doc.replace('/docs/', '')}
                </a>
              ))}
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section id="about" class="py-24 bg-slate-900/5">
    <div class="max-w-5xl mx-auto px-6">
      <h2 class="text-3xl font-bold mb-16">å…³äºè¿™æœ¬ä¹¦</h2>

      <div class="space-y-16">
        <div class="grid md:grid-cols-4 gap-8">
          <div class="text-accent font-mono text-sm tracking-widest uppercase pt-1">01. å®šä½</div>
          <div class="md:col-span-3 text-slate-700 leading-relaxed">
            è¿™ä¸æ˜¯â€œå·¥å…·æ¸…å•â€ï¼Œè€Œæ˜¯â€œå¯æ‰§è¡Œçš„ç§‘ç ”æ“ä½œç³»ç»Ÿâ€ã€‚æ¯ä¸€ç« éƒ½å¼ºè°ƒè¾“å…¥ã€æ‰§è¡Œã€éªŒè¯å’Œäº§å‡ºï¼Œç›®æ ‡æ˜¯å‡å°‘è¿”å·¥ã€æé«˜æŠ•ç¨¿ç¨³å®šæ€§ã€‚
          </div>
        </div>

        <div class="grid md:grid-cols-4 gap-8">
          <div class="text-accent font-mono text-sm tracking-widest uppercase pt-1">02. æ–¹æ³•è®º</div>
          <div class="md:col-span-3">
            <p class="text-xl text-slate-800 leading-relaxed mb-4 font-light">"Claim without evidence is noise."</p>
            <p class="text-slate-600 leading-relaxed text-base">
              ç”¨ç»“æ„åŒ–çš„ Idea äº§å‡ºå¯éªŒè¯ claimï¼Œç”¨å·¥ç¨‹åŒ–ä»£ç ä¿éšœå¯å¤ç°ï¼Œç”¨å›¾è¡¨å’Œå†™ä½œå½¢æˆå¯å®¡ç¨¿çš„å™äº‹ï¼Œæœ€åç”¨å®¡ç¨¿é—­ç¯æŠŠé£é™©æå‰æš´éœ²ã€‚
            </p>
          </div>
        </div>

        <div class="grid md:grid-cols-4 gap-8">
          <div class="text-accent font-mono text-sm tracking-widest uppercase pt-1">03. é€‚ç”¨å¯¹è±¡</div>
          <div class="md:col-span-3">
            <div class="flex flex-wrap gap-x-8 gap-y-4 font-mono text-sm text-slate-600">
              <div>
                <div class="text-slate-800 text-xs opacity-60 mb-1">ç ”ç©¶ç”Ÿ / åšå£«ç”Ÿ</div>
                <div>å»ºç«‹ç¨³å®šæŠ•ç¨¿æµç¨‹</div>
              </div>
              <div>
                <div class="text-slate-800 text-xs opacity-60 mb-1">å·¥ä¸šç ”ç©¶å‘˜</div>
                <div>ç¼©çŸ­ç ”å‘éªŒè¯å‘¨æœŸ</div>
              </div>
              <div>
                <div class="text-slate-800 text-xs opacity-60 mb-1">ç‹¬ç«‹ç ”ç©¶è€…</div>
                <div>ä» 0 åˆ° 1 æ­å»ºç§‘ç ”ç³»ç»Ÿ</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="cooperation" class="py-24 border-t border-slate-900/10">
    <div class="max-w-7xl mx-auto px-6">
      <div class="mb-16 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-4">ç« èŠ‚åä½œåŒº</h2>
        <p class="text-slate-600">ç»“æ„å¤åˆ»å‚è€ƒç«™çš„åˆä½œæ¨¡å—ï¼Œä½†å†…å®¹æ”¹ä¸ºç§‘ç ”ç« èŠ‚å…¥å£</p>
      </div>

      <div class="grid md:grid-cols-3 gap-6 max-w-6xl mx-auto">
        {cooperationCards.map((card) => (
          <div class:list={[
            'border border-slate-900/10 rounded-2xl p-6 hover:border-accent/40 transition-colors',
            card.style,
          ]}>
            <div class="text-4xl mb-6">{card.icon}</div>
            <h3 class="text-xl font-bold mb-2">{card.title}</h3>
            <p class="text-slate-600 mb-6 leading-relaxed text-sm">{card.desc}</p>
            <a href={getPath(card.href)} class="block w-full text-center py-3 bg-slate-900 text-white font-bold rounded-lg hover:bg-slate-800 transition-colors border border-slate-900 text-sm">
              {card.cta}
            </a>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="py-12">
    <Terminal />
  </section>
</Layout>

<script>
  const cards = document.querySelectorAll('.spotlight-card');

  cards.forEach((card) => {
    card.addEventListener('mousemove', (e) => {
      const rect = (card as HTMLElement).getBoundingClientRect();
      const x = (e as MouseEvent).clientX - rect.left;
      const y = (e as MouseEvent).clientY - rect.top;

      (card as HTMLElement).style.setProperty('--x', `${x}px`);
      (card as HTMLElement).style.setProperty('--y', `${y}px`);
    });
  });
</script>
